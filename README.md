# Лабораторная работа 2: Разработка структуры базы данных и подключение к бэкенду

## Цель работы
- Разработка структуры базы данных PostgreSQL по выбранной теме.
- Подключение базы данных к бэкенду приложения.
- Реализация функционала добавления, поиска и удаления данных.

## Описание задания
Необходимо спроектировать и реализовать базу данных PostgreSQL, включающую 4 таблицы, для работы с данными по выбранной теме. Подключить БД к трем страницам приложения из Лабораторной 1. Наполнить таблицы данными через админку Django или Adminer. Реализовать функционал поиска, добавления услуг в заявку (статус "черновик") и логического удаления заявки через SQL-запрос UPDATE. Использовать ORM для большинства операций, за исключением удаления.

### Основные требования
1. **Структура БД**:
   - **Таблица услуг**: поля — наименование, описание, статус (удален/действует), URL изображения (Nullable), поля по предметной области.
   - **Таблица заявок**: 4 обязательных поля (ID, статус, дата создания, создатель), даты формирования/завершения, модератор, поля по предметной области.
   - **Таблица м-м (заявки-услуги)**: составной уникальный ключ, поля количества/порядка/главный/другое.
   - **Таблица пользователей**: системная таблица Django (логин, пароль, признак модератора).
   - **Статусы заявок**: минимум 5 (черновик, удалён, сформирован, завершён, отклонён).
   - Ограничение: не более одной заявки в статусе "черновик" на пользователя.
   - Каскадное удаление запрещено.
   - Одно поле заявки или м-м рассчитывается при завершении заявки.
2. **Функционал**:
   - Поиск и просмотр услуг, добавление в заявку (статус "черновик"), просмотр заявки — через ORM.
   - Логическое удаление заявки (перевод в статус "удалён") — через SQL-запрос UPDATE.
   - Создание заявки в статусе "черновик" при добавлении первой услуги, если её нет.
   - Карточка заявки неактивна, если нет заявки в статусе "черновик".
   - Удалённые заявки недоступны для просмотра.
3. **HTTP-методы**:
   - 3 GET-запроса (поиск, просмотр услуг, просмотр заявки).
   - 1 POST-запрос для добавления услуги в заявку (ORM).
   - 1 POST-запрос для логического удаления заявки (SQL).
4. **ER-диаграмма**: создать в StarUML, указав таблицы, связи, столбцы, типы данных, длину полей, первичные и внешние ключи.

## Порядок демонстрации
1. Показать панель администратора Django/Adminer:
   - Добавить новую услугу.
   - Выполнить SELECT-запрос для просмотра данных.
2. Продемонстрировать 3 страницы приложения:
   - Выполнить поиск.
   - Удалить заявку, попытаться открыть её URL.
   - Добавить две услуги в заявку, показать обновление карточки корзины.
   - Показать содержимое заявки.
3. В БД показать:
   - Результаты логического удаления (SELECT).
   - Новую заявку (SELECT).
   - Изменение полей заявки и м-м, их отображение в приложении.
4. В коде показать:
   - Модели БД.
   - Составной уникальный ключ м-м.
   - 4 контроллера (через ORM).
   - Реализацию удаления заявки через SQL UPDATE.

## Контрольные вопросы
- Виды баз данных.
- SQL-запросы и курсоры.
- ORM, модели и миграции.
- Принципы чистой архитектуры.

## Используемые технологии
- **PostgreSQL**: для хранения данных.
- **Django/Adminer**: для управления данными.
- **StarUML**: для ER-диаграммы.
- **Django ORM**: для работы с данными.
- **SQL**: для логического удаления.

